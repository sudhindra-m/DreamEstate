<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream Home Listings | Responsive Real Estate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary': '#10b981', 
                        'secondary': '#059669',
                        'background': '#f9fafb',
                    }
                }
            }
        }
    </script>
    <style>
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background: #9ca3af;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        #property-detail-modal {
            display: none;
        }
    </style>
</head>

<body class="font-sans bg-background min-h-screen">

    <header class="bg-white shadow-md sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold text-primary tracking-tight">
                Dream<span class="text-gray-800">Estate</span>
            </a>
            <nav class="hidden md:flex space-x-6 text-gray-600 font-medium">
                <a href="index.html" class="hover:text-primary transition duration-150">Home</a>
                <a href="buy.html" class="hover:text-primary transition duration-150">Buy</a>
                <a href="rent.html" class="hover:text-primary transition duration-150">Rent</a>
                <a href="sell.html" class="hover:text-primary transition duration-150">Sell</a>
                <a href="about.html" class="hover:text-primary transition duration-150">About Us</a>
            </nav>
            <button class="md:hidden p-2 rounded-lg text-gray-600 hover:bg-gray-100">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                </svg>
            </button>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <h1 class="text-4xl font-extrabold text-gray-900 mb-2">Find Your Perfect Home</h1>
        <p class="text-lg text-gray-500 mb-8">Browse hundreds of properties, updated daily.</p>

        <div class="bg-white p-4 sm:p-6 rounded-xl shadow-lg mb-10 border border-gray-100">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                
                <div>
                    <label for="location-filter" class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                    <select id="location-filter" class="w-full border-gray-300 rounded-lg shadow-sm focus:border-primary focus:ring-primary p-2 transition duration-150">
                        <option value="">All Locations</option>
                        <option value="Downtown">Downtown</option>
                        <option value="Suburbia">Suburbia</option>
                        <option value="Waterfront">Waterfront</option>
                    </select>
                </div>

                <div>
                    <label for="type-filter" class="block text-sm font-medium text-gray-700 mb-1">Property Type</label>
                    <select id="type-filter" class="w-full border-gray-300 rounded-lg shadow-sm focus:border-primary focus:ring-primary p-2 transition duration-150">
                        <option value="">All Types</option>
                        <option value="Apartment">Apartment</option>
                        <option value="House">House</option>
                        <option value="Villa">Villa</option>
                    </select>
                </div>

                <div>
                    <label for="price-filter" class="block text-sm font-medium text-gray-700 mb-1">Max Price (INR)</label>
                    <input type="range" id="price-filter" min="1000000" max="50000000" step="1000000" value="50000000" class="w-full h-8 appearance-none bg-gray-200 rounded-lg transition duration-150" oninput="document.getElementById('price-display').innerText = new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0 }).format(this.value)">
                    <p class="text-sm text-gray-500 mt-1">Up to <span id="price-display" class="font-semibold text-gray-800">â‚¹5,00,00,000</span></p>
                </div>

                <div class="flex items-end">
                    <button id="apply-filters" class="w-full bg-primary text-white font-semibold py-3 px-4 rounded-lg hover:bg-secondary transition duration-300 shadow-md hover:shadow-lg">
                        Apply Filters
                    </button>
                </div>
            </div>
        </div>

        <div id="property-listings" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
        </div>

        <div id="no-results" class="hidden text-center py-12">
            <h3 class="text-xl font-semibold text-gray-700">No Properties Found</h3>
            <p class="text-gray-500 mt-2">Try adjusting your filters for more results.</p>
        </div>

        <div id="loading-spinner" class="text-center py-12 hidden">
            <svg class="animate-spin h-10 w-10 text-primary mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="text-primary mt-3">Loading properties...</p>
        </div>
    </main>

    <div id="property-detail-modal" class="fixed inset-0 z-50 bg-gray-900 bg-opacity-75 overflow-y-auto transition-opacity duration-300">
        <div class="flex items-start justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

            <div id="modal-content" class="inline-block align-bottom bg-white rounded-xl text-left overflow-hidden shadow-2xl transform transition-all my-8 sm:align-middle sm:max-w-3xl sm:w-full">
            </div>
        </div>
    </div>


    <script>
        const MOCK_PROPERTIES = [
            { id: 1, title: "Luxury Sky Loft", location: "Downtown", type: "Apartment", price: 12500000, beds: 3, baths: 3, sqft: 2100, image: "https://placehold.co/600x400/10b981/ffffff?text=Loft+View", description: "Stunning views and modern amenities in the heart of the city." },
            { id: 2, title: "Suburban Family Home", location: "Suburbia", type: "House", price: 7800000, beds: 4, baths: 2, sqft: 2800, image: "https://placehold.co/600x400/059669/ffffff?text=Family+Home", description: "Large garden, excellent school district, and spacious living areas." },
            { id: 3, title: "Beachfront Villa", location: "Waterfront", type: "Villa", price: 25000000, beds: 5, baths: 4, sqft: 3500, image: "https://placehold.co/600x400/f59e0b/ffffff?text=Ocean+Villa", description: "Private beach access and an infinity pool overlooking the ocean." },
            { id: 4, title: "Cozy Studio Flat", location: "Downtown", type: "Apartment", price: 3500000, beds: 1, baths: 1, sqft: 650, image: "https://placehold.co/600x400/6366f1/ffffff?text=Studio+Flat", description: "Perfect starter home, walking distance to all major transit lines." },
            { id: 5, title: "Modern Ranch House", location: "Suburbia", type: "House", price: 8900000, beds: 3, baths: 2, sqft: 2400, image: "https://placehold.co/600x400/ef4444/ffffff?text=Ranch+House", description: "Recently renovated with an open-concept kitchen and sunroom." },
            { id: 6, title: "Riverside Getaway", location: "Waterfront", type: "House", price: 11000000, beds: 3, baths: 2, sqft: 2200, image: "https://placehold.co/600x400/3b82f6/ffffff?text=Riverside", description: "Tranquil setting with a private dock and beautiful river views." },
        ];

        const formatCurrency = (amount) => {
            return new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0 }).format(amount);
        };

        const createPropertyCard = (property) => {
            return `
                <div 
                    class="property-card bg-white rounded-xl shadow-lg hover:shadow-xl transition duration-300 transform hover:scale-[1.02] cursor-pointer border border-gray-200"
                    data-property-id="${property.id}"
                >
                    <img src="${property.image}" alt="${property.title}" class="w-full h-48 object-cover rounded-t-xl" 
                         onerror="this.onerror=null;this.src='https://placehold.co/600x400/94a3b8/ffffff?text=Image+Unavailable';"
                    >
                    <div class="p-5">
                        <h2 class="text-xl font-bold text-gray-900 mb-1">${property.title}</h2>
                        <p class="text-sm text-gray-500 flex items-center mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-primary" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
                            </svg>
                            ${property.location}
                        </p>
                        <p class="text-2xl font-extrabold text-primary mb-4">${formatCurrency(property.price)}</p>
                        
                        <div class="flex justify-between text-sm text-gray-600 border-t pt-3">
                            <div class="text-center">
                                <p class="font-semibold">${property.beds}</p>
                                <p>Beds</p>
                            </div>
                            <div class="text-center">
                                <p class="font-semibold">${property.baths}</p>
                                <p>Baths</p>
                            </div>
                            <div class="text-center">
                                <p class="font-semibold">${property.sqft.toLocaleString()}</p>
                                <p>Sq. Ft.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        };

        const renderProperties = (properties) => {
            const container = document.getElementById('property-listings');
            const noResults = document.getElementById('no-results');
            container.innerHTML = ''; 

            if (properties.length === 0) {
                noResults.classList.remove('hidden');
                return;
            }
            
            noResults.classList.add('hidden');
            const html = properties.map(createPropertyCard).join('');
            container.innerHTML = html;
        };

        const showPropertyDetail = (property) => {
            const modal = document.getElementById('property-detail-modal');
            const modalContent = document.getElementById('modal-content');

            modalContent.innerHTML = `
                <div class="relative">
                    <button 
                        class="absolute top-4 right-4 p-2 bg-white rounded-full shadow-lg text-gray-700 hover:bg-gray-100 transition"
                        onclick="hidePropertyDetail()"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>

                    <img src="${property.image}" alt="${property.title}" class="w-full h-64 object-cover" 
                         onerror="this.onerror=null;this.src='https://placehold.co/800x400/94a3b8/ffffff?text=Image+Unavailable';"
                    >
                    <div class="p-6 sm:p-8">
                        <h2 class="text-3xl font-extrabold text-gray-900 mb-2">${property.title}</h2>
                        <p class="text-xl font-bold text-primary mb-4">${formatCurrency(property.price)}</p>
                        
                        <div class="flex flex-wrap gap-4 text-sm font-medium text-gray-600 mb-6">
                            <span class="flex items-center p-2 bg-gray-100 rounded-lg">
                                ${property.beds} Beds
                            </span>
                            <span class="flex items-center p-2 bg-gray-100 rounded-lg">
                                ${property.baths} Baths
                            </span>
                            <span class="flex items-center p-2 bg-gray-100 rounded-lg">
                                ${property.sqft.toLocaleString()} Sq. Ft.
                            </span>
                            <span class="flex items-center p-2 bg-gray-100 rounded-lg">
                                ${property.type}
                            </span>
                            <span class="flex items-center p-2 bg-primary text-white rounded-lg">
                                ${property.location}
                            </span>
                        </div>

                        <h3 class="text-xl font-semibold text-gray-800 mb-3 border-t pt-4">Property Details</h3>
                        <p class="text-gray-600 leading-relaxed">${property.description} This is a longer description to provide more context. The property features a state-of-the-art security system, proximity to parks, and low maintenance fees. Schedule a viewing today!</p>

                        <div class="mt-8">
                            <button class="bg-primary text-white font-semibold py-3 px-6 rounded-lg hover:bg-secondary transition duration-300 shadow-md">
                                Contact Agent
                            </button>
                            <button class="ml-4 text-gray-600 font-semibold py-3 px-6 rounded-lg border border-gray-300 hover:bg-gray-50 transition duration-300" onclick="hidePropertyDetail()">
                                Back to Listings
                            </button>
                        </div>
                    </div>
                </div>
            `;
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        };

        const hidePropertyDetail = () => {
            const modal = document.getElementById('property-detail-modal');
            modal.style.display = 'none';
            document.body.style.overflow = '';
        };

        const fetchPropertiesWithBackoff = async (maxRetries = 3, delay = 1000) => {
            const spinner = document.getElementById('loading-spinner');
            spinner.classList.remove('hidden');

            for (let i = 0; i < maxRetries; i++) {
                try {
                    await new Promise(resolve => setTimeout(resolve, Math.random() * 600 + 200)); 
                    
                    return MOCK_PROPERTIES; 
                } catch (error) {
                    console.error(`Attempt ${i + 1} failed:`, error);
                    if (i < maxRetries - 1) {
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2; 
                    } else {
                        throw new Error('Failed to fetch properties after multiple retries.');
                    }
                }
            }
        };

        let allProperties = [];
        const loadAndFilterProperties = async () => {
            try {
                allProperties = await fetchPropertiesWithBackoff();
                
                const location = document.getElementById('location-filter').value;
                const type = document.getElementById('type-filter').value;
                const maxPrice = parseInt(document.getElementById('price-filter').value);

                const filteredProperties = allProperties.filter(property => {
                    const locationMatch = location ? property.location === location : true;
                    const typeMatch = type ? property.type === type : true;
                    const priceMatch = property.price <= maxPrice;
                    return locationMatch && typeMatch && priceMatch;
                });

                renderProperties(filteredProperties);

            } catch (error) {
                const container = document.getElementById('property-listings');
                container.innerHTML = `<div class="col-span-full text-center py-12 text-red-600 font-semibold">Error loading data: ${error.message}</div>`;
                console.error("Critical rendering error:", error);
            } finally {
                document.getElementById('loading-spinner').classList.add('hidden');
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            loadAndFilterProperties(); 

            document.getElementById('apply-filters').addEventListener('click', loadAndFilterProperties);

            document.getElementById('property-listings').addEventListener('click', (event) => {
                const card = event.target.closest('.property-card');
                if (card) {
                    const propertyId = parseInt(card.getAttribute('data-property-id'));
                    const property = allProperties.find(p => p.id === propertyId);
                    if (property) {
                        showPropertyDetail(property);
                    }
                }
            });

            document.getElementById('property-detail-modal').addEventListener('click', (event) => {
                if (event.target.id === 'property-detail-modal') {
                    hidePropertyDetail();
                }
            });
            
            document.addEventListener('keydown', (event) => {
                if (event.key === "Escape" && document.getElementById('property-detail-modal').style.display === 'block') {
                    hidePropertyDetail();
                }
            });
        });
    </script>

</body>
</html>